<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<!-- Шрифты Google -->
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&display=swap" rel="stylesheet" />
<!-- Иконки Font Awesome 6 -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
<style>
  :root {
    --bg-color: #f0f2f5;
    --text-color: #222;
    --section-bg: #fff;
    --border-color: #d0d0d0;
    --primary-gradient: linear-gradient(135deg, #4CAF50, #66bb6a);
    --hover-gradient: linear-gradient(135deg, #45a049, #5fa362);
    --shadow: rgba(0,0,0,0.1);
    --btn-bg: #4CAF50;
    --btn-hover-bg: #45a049;
  }

  body {
    font-family: 'Montserrat', sans-serif;
    margin: 0;
    padding: 30px;
    background: var(--bg-color);
    color: var(--text-color);
    transition: background 0.5s, color 0.5s;
    line-height: 1.6;
  }

  /* Тёмная тема */
  body.dark-theme {
    --bg-color: #222;
    --text-color: #eee;
    --section-bg: #333;
    --border-color: #555;
    --primary-gradient: linear-gradient(135deg, #66bb6a, #4CAF50);
    --hover-gradient: linear-gradient(135deg, #5fa362, #45a049);
    --shadow: rgba(0,0,0,0.3);
    --btn-bg: #66bb6a;
    --btn-hover-bg: #5fa362;
  }
  #footer {
  position: fixed;
  bottom: 10px;
  width: 100%;
  text-align: center;
  font-family: 'Arial', sans-serif;
  font-size: 14px;
  color: var(--text-color);
  padding: 12px 20px;
  box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
  border-radius: 16px 16px 0 0;
  backdrop-filter: blur(4px);
  transition: all 0.3s ease;
  cursor: default;
}

#footer span {
  display: inline-block;
  font-weight: 600;
  letter-spacing: 0.5px;
}
  h2 {
    text-align: center;
    font-size: 40px;
    font-weight: 700;
    margin-bottom: 50px;
    color: var(--text-color);
    text-shadow: 1px 1px 4px rgba(0,0,0,0.1);
  }
 /* Стиль для кнопки "Назад" */
  .back-btn {
    display: inline-block;
    margin-top: 50px;
    padding: 15px 20px;
    font-size: 1.2em;
    font-weight: 600;
    color: #fff;
    background-color: #ff5722; /* яркий цвет для выделения */
    border: none;
    border-radius: 8px;
    cursor: pointer;
    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    transition: background-color 0.3s, transform 0.2s;
  }
  .back-btn:hover {
    background-color: #e64a19; /* чуть темнее при наведении */
    transform: translateY(-2px);
  }
  /* Переключатель темы */
  .theme-switcher {
    position: fixed;
    top: 20px;
    right: 20px;
    display: flex;
    align-items: center;
    gap: 10px;
    z-index: 999;
    font-size: 14px;
    background: rgba(255,255,255,0.8);
    padding: 8px 12px;
    border-radius: 8px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.2);
  }
  .theme-switcher input[type="checkbox"] {
    width: 50px;
    height: 25px;
    appearance: none;
    background: #c6c6c6;
    outline: none;
    border-radius: 25px;
    position: relative;
    transition: background 0.3s;
    cursor: pointer;
  }
  .theme-switcher input[type="checkbox"]:checked {
    background: #66bb6a;
  }
  .theme-switcher input[type="checkbox"]::before {
    content: "";
    position: absolute;
    top: 2px;
    left: 2px;
    width: 21px;
    height: 21px;
    border-radius: 50%;
    background: #fff;
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    transition: 0.3s;
  }
  input[type="checkbox"]:checked::before {
    transform: translateX(25px);
  }

  /* Общий стиль секций */
  .section {
    background: var(--section-bg);
    border-radius: 20px;
    padding: 30px;
    margin-top: 40px;
    box-shadow: 0 16px 32px var(--shadow);
    transition: box-shadow 0.3s, transform 0.3s, background 0.3s;
  }
  .section:hover {
    box-shadow: 0 20px 40px var(--shadow);
    transform: translateY(-4px);
  }

  /* Заголовки секций */
  .section h3 {
    margin-top: 0;
    margin-bottom: 20px;
    font-size: 22px;
    font-weight: 600;
    color: var(--text-color);
    display: flex;
    align-items: center;
    border-bottom: 2px solid var(--border-color);
    padding-bottom: 8px;
  }
  .section h3 i {
    margin-right: 12px;
    font-size: 24px;
    transition: color 0.3s;
    color: #4CAF50;
  }
  .section h3:hover i {
    color: #388E3C;
  }

  /* Метки и поля */
  label {
    display: block;
    margin-bottom: 15px;
    font-weight: 500;
  }
  input[type="text"], select, textarea {
    width: 100%;
    padding: 14px 20px;
    border-radius: 12px;
    border: 1px solid var(--border-color);
    font-size: 16px;
    transition: border-color 0.3s, box-shadow 0.3s, transform 0.2s;
  }
  input[type="text"]:focus, select:focus, textarea:focus {
    border-color: #4CAF50;
    box-shadow: 0 0 12px rgba(76, 175, 80, 0.2);
    outline: none;
    transform: scale(1.02);
  }

  /* Кнопки */
button {
    padding: 14px 30px;
    font-size: 17px;
    border: none;
    border-radius: 12px;
    cursor: pointer;
    background: var(--primary-gradient);
    color: #fff;
    box-shadow: 0 4px 15px rgba(76, 175, 80, 0.2);
    transition: all 0.3s ease;
    display: inline-flex;
    align-items: center;
    font-weight: 600;
  }
button i {
    margin-right: 12px;
    font-size: 20px;
    transition: transform 0.3s;
}
button:hover {
    background: var(--hover-gradient);
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(76, 175, 80, 0.3);
}
button:hover i {
    transform: rotate(10deg);
}

/* Центрирование кнопки */
#saveBtn {
    display: inline-block;
    margin-top: 25px;
    padding: 14px 40px;
}

/* Таблица */
#tableContainer {
    margin-top: 50px;
}
table {
    width: 100%;
    border-collapse: separate;
    border-spacing: 0;
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 20px 40px rgba(0,0,0,0.1);
    background: #fff;
    transition: background 0.3s, box-shadow 0.3s;
}
body.dark-theme table {
    background: #444;
    box-shadow: 0 20px 40px rgba(0,0,0,0.5);
}
thead {
    background: linear-gradient(135deg, #f7f7f7, #e0e0e0);
    transition: background 0.3s;
}
body.dark-theme thead {
    background: linear-gradient(135deg, #555, #333);
}
th {
    padding: 16px 20px;
    font-weight: 600;
    font-size: 17px;
    text-align: center;
    border-bottom: 2px solid var(--border-color);
    color: var(--text-color);
}
td {
    padding: 16px 20px;
    border-bottom: 1px solid var(--border-color);
    font-size: 16px;
    transition: background-color 0.2s, transform 0.2s, color 0.3s;
    background-color: transparent;
    color: inherit;
}
td.editable {
    background-color: #fff8dc;
    cursor: text;
}
body.dark-theme td.editable {
    background-color: #777;
}
td:hover {
    background-color: #f0f0f0;
}
body.dark-theme td:hover {
    background-color: #666;
}

/* Уведомление */
#notification {
  position: fixed;
  top: 20px;
  left: 50%;
  transform: translateX(-50%);
  background: #4CAF50;
  color: #fff;
  padding: 15px 25px;
  border-radius: 8px;
  box-shadow: 0 4px 10px rgba(0,0,0,0.2);
  font-size: 16px;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.4s ease, transform 0.4s ease;
  z-index: 1000;
}
#notification.show {
  opacity: 1;
  pointer-events: auto;
  transform: translateX(-50%) translateY(0);
}

/* Расположение блока слева с красивым стилем */
#changelogContainer {
  display: none; /* по умолчанию скрыт */
  position: fixed; top: 70px; left: 20px; /* слева */
  width: 420px;
  max-height: 500px;
  overflow-y: auto;
  background: var(--bg-color);
  padding: 20px;
  border-radius: 12px;
  box-shadow: 0 8px 20px rgba(0,0,0,0.2);
  z-index: 9999;
  font-family: 'Montserrat', sans-serif;
  font-size: 14px;
  color: var(--text-color);
  transition: opacity 0.3s, transform 0.3s;
}
#changelogContainer.show {
  display: block;
  opacity: 1;
  transform: translateY(0);
}
#changelogContainer h4 {
  margin-top: 0;
  font-size: 18px;
  margin-bottom: 15px;
  font-weight: 600;
  border-bottom: 2px solid #ddd;
  padding-bottom: 8px;
  color: var(--text-color);
}

/* Стиль для каждой записи */
.changelog-entry {
  margin-bottom: 10px;
  padding: 12px 15px;
  background-color: var(--section-bg);
  border-radius: 8px;
  box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);
  transition: background 0.2s, transform 0.2s;
}
.changelog-entry:hover {
  background-color: var(--section-bg);
  transform: translateY(-2px);
}

/* Заголовки внутри записи */
.changelog-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px;
}
.changelog-version {
  font-weight: 600;
  font-size: 15px;
  color: var(--text-color);
}
.changelog-date {
  font-size: 13px;
  color: #7f8c8d;
}
.changelog-type {
  display: inline-block;
  padding: 2px 8px;
  border-radius: 12px;
  font-size: 12px;
  font-weight: 500;
  color: #fff;
  background-color: #3498db;
}
#bugReportBtn {
  display: flex;
  align-items: center;
  justify-content: center;
  background: var(--section-bg);
  color: var(--text-color);
  border: none;
  border-radius: 50%;
  width: 50px;
  height: 50px;
  cursor: pointer;
  box-shadow: 0 4px 8px rgba(0,0,0,0.2);
  padding: 0; /* убираем любые внутренние отступы */
}

/* Можно убрать font-size у кнопки, оставить только у иконки */
#bugReportBtn i {
  display: block;
  margin: 0;
}
/* Цвет для типов */
.changelog-type.Добавлено { background-color: #27ae60; }
.changelog-type.Исправлено { background-color: #f39c12; }
.changelog-type.Общее { background-color: #8e44ad; }
</style>
</head>
<body>
  <!-- Новый футер -->
<div id="footer">
  <span>Создатель сайта: EmPsOn &copy; 2025</span>
</div>
<!-- Уведомление -->
<div id="notification"></div>
<div style="margin-bottom:20px;">
  <button class="back-btn" onclick="window.open('index.html', '_self')">← Назад на главную</button>
</div>
<!-- Переключатель темы -->
<div class="theme-switcher">
  <label for="themeToggle" style="color: var(--text-color); font-weight: 500;">Тёмная тема</label>
  <input type="checkbox" id="themeToggle" />
</div>

<!-- Блок changelog -->
<div style="position: fixed; top: 20px; left: 20px; z-index: 9999;">
  <button id="changelogToggle" style="padding:10px 15px; border:none; border-radius:8px; background:var(--primary-gradient); color:#fff; cursor:pointer; font-weight:600; box-shadow: 0 2px 8px rgba(0,0,0,0.2); transition: background 0.3s;">
    Changelog
  </button>
</div>
<div id="changelogContainer">
  <h4 style="margin-top:0;">История изменений</h4>
  <textarea id="changelogText" placeholder="Введите или редактируйте историю изменений..."></textarea>
  <button id="saveChangelog"><i class="fas fa-save"></i> Сохранить</button>
</div>

<!-- Выбор колонки для работы -->
<div class="section">
  <h3><i class="fas fa-columns"></i>Выберите колонку для работы</h3>
  <label>
    <strong>Колонка:</strong>
    <select id="columnSelect" style="width:100%; padding:14px; border-radius:12px; border:1px solid var(--border-color); font-size:16px;">
      <option value="15">Details</option>
      <option value="16">Description</option>
    </select>
  </label>
</div>

<!-- Загрузка файла -->
<div class="section">
  <h3><i class="fas fa-upload"></i>Загрузите CSV файл</h3>
  <input type="file" id="fileInput" accept=".csv" style="width:98%; padding:14px; border-radius:12px; border:1px solid var(--border-color); font-size:16px; cursor:pointer; box-shadow: inset 0 0 5px rgba(0,0,0,0.1);" />
</div>

<!-- Режим замены -->
<div class="section">
  <h3><i class="fas fa-sync-alt"></i>Режим замены</h3>
  <label>
    <strong>Выберите режим:</strong>
    <select id="modeSelect" style="width:100%; padding:14px; border-radius:12px; border:1px solid var(--border-color); font-size:16px;">
      <option value="html">Заменить HTML</option>
      <option value="text">Заменить текст</option>
    </select>
  </label>
  <label>
    <strong>Искомое значение:</strong>
    <input type="text" id="searchHtml" placeholder="Введите HTML или текст" />
  </label>
  <label>
    <strong>Новое значение:</strong>
    <input type="text" id="replaceHtml" placeholder="Введите новое HTML или текст" />
  </label>
  <div style="text-align:center; margin-top:10px;">
    <button id="replaceBtn" style="padding:14px 20px; font-size:16px;"><i class="fas fa-sync-alt"></i> Заменить</button>
  </div>
</div>

<!-- Поиск по кодам 1С -->
<div class="section">
  <h3><i class="fas fa-search"></i>Поиск по кодам 1С</h3>
  <label>
    <strong>Введите коды 1С (через запятую или пробел):</strong>
    <input type="text" id="codesSearch" placeholder="например: 001, 123 456" />
  </label>
  <div style="text-align:center; margin-top:10px;">
    <button id="searchCodesBtn" style="padding:14px 20px; font-size:16px;"><i class="fas fa-search"></i> Искать по кодам 1С</button>
  </div>
</div>

<!-- Вставка данных -->
<div class="section">
  <h3><i class="fas fa-plus-circle"></i>Добавить текст/html</h3>
  <label>
    <strong>Что вставлять:</strong>
    <input type="text" id="insertText" placeholder="Введите текст" />
  </label>
  <label>
    <strong>Тип вставляемого содержимого:</strong>
    <select id="insertType" style="width:100%; padding:14px; border-radius:12px; border:1px solid var(--border-color); font-size:16px;">
      <option value="text">Текст</option>
      <option value="html">HTML</option>
    </select>
  </label>
  <label>
    <strong>Вставлять:</strong>
    <select id="insertPosition" style="width:100%; padding:14px; border-radius:12px; border:1px solid var(--border-color); font-size:16px;">
      <option value="start">В начало</option>
      <option value="end">В конец</option>
    </select>
  </label>
  <div style="text-align:center; margin-top:10px;">
    <button id="insertBtn" style="padding:14px 20px; font-size:16px;"><i class="fas fa-plus-circle"></i> Добавить</button>
  </div>
</div>

<!-- Кнопка сохранения -->
<div style="margin-top:50px; text-align:center;">
  <button id="saveBtn" style="padding:14px 20px; font-size:16px;"><i class="fas fa-save"></i> Сохранить изменения</button>
</div>

<!-- Таблица -->
<div id="tableContainer"></div>

<!-- Кнопка баг-репорта -->
<div style="position: fixed; bottom: 70px; right: 10px; z-index: 9999;">
  <button id="bugReportBtn" style="
    background:#f44336; 
    color:#fff; 
    border:none; 
    border-radius:50%; 
    width:50px; 
    height:50px; 
    cursor:pointer; 
    box-shadow:0 4px 8px rgba(0,0,0,0.2); 
    display: flex; 
    align-items: center; 
    justify-content: center;
    padding: 0;
  ">
    <i class="fas fa-bug" style="font-size:24px; display: block; line-height: 1; text-align: center;"></i>
  </button>
</div>

<!-- Модальное окно для описания бага -->
<div id="bugModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.6); align-items:center; justify-content:center; z-index:10000;">
  <div style="background: var(--section-bg); padding:20px; border-radius:8px; max-width:500px; width:90%; position:relative;">
    <h3>Сообщить о баге</h3>
    <textarea id="bugDescription" style="width:99%; height:150px; padding:10px; border-radius:6px; border:1px solid #ccc; color: var(--text-color); background: var(--section-bg);" placeholder="Опишите проблему..."></textarea>
    <div style="margin-top:10px; display:flex; justify-content:flex-end;">
      <button id="sendBug" style="background:#4CAF50; color:#fff; border:none; padding:10px 20px; border-radius:6px; cursor:pointer; margin-right:10px;">Отправить</button>
      <button id="closeBugModal" style="background:#ccc; color:#000; border:none; padding:10px 20px; border-radius:6px; cursor:pointer;">Отмена</button>
    </div>
  </div>
</div>

<script src="https://unpkg.com/papaparse@5.3.0/papaparse.min.js"></script>
<script>
let csvData = [];
let headers = [];
let selectedColumnIndex = 15; // по умолчанию 16-й столбец

// Обработчик выбора
document.getElementById('columnSelect').addEventListener('change', (e) => {
  selectedColumnIndex = parseInt(e.target.value);
  renderTable();
});

// Переключатель темы
const themeToggle = document.getElementById('themeToggle');
themeToggle.addEventListener('change', () => {
  document.body.classList.toggle('dark-theme', themeToggle.checked);
});

// Функция для уведомлений
function showNotification(message) {
  const notif = document.getElementById('notification');
  notif.innerText = message;
  notif.classList.add('show');
  setTimeout(() => {
    notif.classList.remove('show');
  }, 3000);
}

// Загрузка файла
document.getElementById('fileInput').addEventListener('change', function(e) {
  const file = e.target.files[0];
  if (file) {
    Papa.parse(file, {
      header: false,
      skipEmptyLines: true,
      delimiter: ';',
      complete: function(results) {
        headers = results.data[0];
        csvData = results.data.slice(1).map(row => {
          const obj = {};
          headers.forEach((h, i) => {
            obj[h] = row[i] || '';
          });
          obj._visible = true;
          return obj;
        });
        renderTable();
      },
      error: function(err) {
        alert('Ошибка при парсинге файла: ' + err.message);
      }
    });
  }
});

function renderTable() {
  const container = document.getElementById('tableContainer');
  container.innerHTML = '';

  const table = document.createElement('table');

  const thead = document.createElement('thead');
  const headerRow = document.createElement('tr');

  // Заголовки
  const thSelected = document.createElement('th');
  thSelected.innerText = headers[selectedColumnIndex];
  headerRow.appendChild(thSelected);

  const thItemID = document.createElement('th');
  thItemID.innerText = 'ItemID';
  headerRow.appendChild(thItemID);

  thead.appendChild(headerRow);
  table.appendChild(thead);

  const tbody = document.createElement('tbody');
  csvData.forEach(row => {
    if (row._visible === false) return;
    const tr = document.createElement('tr');

    // выбранный столбец
    const tdSelected = document.createElement('td');
    const colName = headers[selectedColumnIndex];

    if (selectedColumnIndex === 15 || selectedColumnIndex === 16) {
      tdSelected.classList.add('editable');
      tdSelected.contentEditable = true;
      tdSelected.innerHTML = row[colName] || '';
      tdSelected.addEventListener('blur', () => {
        row[colName] = tdSelected.innerHTML;
      });
    } else if (selectedColumnIndex === 11) {
      tdSelected.innerText = row[colName] || '';
    }
    tr.appendChild(tdSelected);

    // ItemID
    const tdItemID = document.createElement('td');
    tdItemID.innerText = row['ItemID'] || '';
    tr.appendChild(tdItemID);

    tbody.appendChild(tr);
  });
  table.appendChild(tbody);
  container.appendChild(table);
}

document.getElementById('replaceBtn').addEventListener('click', () => {
  const mode = document.getElementById('modeSelect').value;
  const searchVal = document.getElementById('searchHtml').value;
  const replaceVal = document.getElementById('replaceHtml').value;

  if (!headers.length || !csvData.length) {
    alert('Загрузите CSV файл.');
    return;
  }
  if (searchVal.trim() === '') {
    alert('Введите значение для поиска.');
    return;
  }

  let count = 0;
  function escapeRegExp(string) {
    return string.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
  }
  const regex = new RegExp(escapeRegExp(searchVal), 'g');

  csvData.forEach(row => {
    if (row._visible !== undefined && row._visible !== true) return;
    const cellContent = row[headers[selectedColumnIndex]] || '';
    if (cellContent.includes(searchVal)) {
      row[headers[selectedColumnIndex]] = cellContent.replace(regex, replaceVal);
      count++;
    }
  });

  renderTable();
  showNotification(`Успешно заменено ${count} ячеек`);
});

document.getElementById('searchCodesBtn').addEventListener('click', () => {
  const input = document.getElementById('codesSearch').value.trim();
  if (!headers.length) {
    alert('Загрузите CSV файл.');
    return;
  }
  if (!input) {
    csvData.forEach(row => (row._visible = true));
    renderTable();
    showNotification(`Показаны все строки`);
    return;
  }
  const codes = input.split(/[\s,]+/).filter(c => c);
  let count = 0;
  csvData.forEach(row => {
    const cellVal = row[headers[11]] || '';
    if (codes.some(code => cellVal.includes(code))) {
      row._visible = true;
      count++;
    } else {
      row._visible = false;
    }
  });
  renderTable();
  showNotification(`Найдено ${count} строк по кодам`);
});

document.getElementById('insertBtn').addEventListener('click', () => {
  const content = document.getElementById('insertText').value;
  const type = document.getElementById('insertType').value;
  const position = document.getElementById('insertPosition').value;
  const isFilterActive = document.getElementById('codesSearch').value.trim() !== '';

  let count = 0;
  csvData.forEach(row => {
    if (isFilterActive && row._visible !== true) return;
    if (type === 'html' || type === 'text') {
      if (position === 'start') {
        row[headers[selectedColumnIndex]] = content + (row[headers[selectedColumnIndex]] || '');
      } else {
        row[headers[selectedColumnIndex]] = (row[headers[selectedColumnIndex]] || '') + content;
      }
      count++;
    }
  });
  renderTable();
  showNotification(`Добавлено ${count} строк`);
});

document.getElementById('saveBtn').addEventListener('click', () => {
  if (!headers.length || !csvData.length) {
    alert('Нет данных для сохранения.');
    return;
  }

  const columnIndex = selectedColumnIndex;
  const itemIdIndex = 11; // индекс колонки ItemID
  const columnHeader = headers[columnIndex];
  const itemIdHeader = headers[itemIdIndex];

  const csvRows = [];
  csvRows.push(`${itemIdHeader};${columnHeader}`); // разделитель - точка с запятой

  csvData.forEach(row => {
    if (row._visible === false) return;
    let cell1 = row[columnHeader] || '';
    let cell2 = row[itemIdHeader] || '';

    if (typeof cell1 === 'string' && /[;"\n]/.test(cell1)) {
      cell1 = `"${cell1.replace(/"/g, '""')}"`;
    }
    if (typeof cell2 === 'string' && /[;"\n]/.test(cell2)) {
      cell2 = `"${cell2.replace(/"/g, '""')}"`;
    }

    csvRows.push(`${cell1};${cell2}`);
  });

  const csvString = csvRows.join('\n');

  const blob = new Blob([csvString], { type: 'text/csv;charset=utf-8;' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = 'new.csv';
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  showNotification(`Файл успешно сохранен`);
});

// =================== БЛОК ОТПРАВКИ В GITHUB ===================
// Замените эти переменные на свои данные
const GITHUB_TOKEN = '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'; // вставьте сюда ваш токен
const REPO_OWNER = 'Sagatheror'; // например: 'EmPsOn'
const REPO_NAME = 'instrumenti'; // например: 'bug-reports'

// Открытие окна баг-репорта
document.getElementById('bugReportBtn').addEventListener('click', () => {
  document.getElementById('bugModal').style.display = 'flex';
});

// Закрытие окна
document.getElementById('closeBugModal').addEventListener('click', () => {
  document.getElementById('bugModal').style.display = 'none';
});

// Отправка бага в GitHub
document.getElementById('sendBug').addEventListener('click', () => {
  const description = document.getElementById('bugDescription').value.trim();
  if (description === '') {
    alert('Пожалуйста, опишите проблему.');
    return;
  }
  const title = `Ошибка/баг от пользователя ${navigator.userAgent}`;
  const body = `**Дата:** ${new Date().toISOString()}\n\n**Описание:**\n${description}`;

  fetch(`https://api.github.com/repos/${REPO_OWNER}/${REPO_NAME}/issues`, {
    method: 'POST',
    headers: {
      'Authorization': 'token ' + GITHUB_TOKEN,
      'Accept': 'application/vnd.github+json',
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({ title: title, body: body })
  })
  .then(response => {
    if (response.ok) {
      alert('Баг успешно отправлен в GitHub! Спасибо за отзыв.');
      document.getElementById('bugDescription').value = '';
      document.getElementById('bugModal').style.display = 'none';
    } else {
      return response.json().then(data => {
        throw new Error(data.message || 'Ошибка при отправке');
      });
    }
  })
  .catch(error => {
    alert('Не удалось отправить баг: ' + error.message);
  });
});
</script>
</body>
</html>
