<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<style>
  body {
    margin: 0;
    height: 100vh;
    overflow: hidden;
    font-family: 'Arial', sans-serif;
    position: relative;
    background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
  }

  /* Фоновые элементы и кнопки */
  canvas {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    display: block;
    z-index: -1;
  }

  .buttons {
    position: relative;
    display: flex;
    gap: 50px;
    justify-content: center;
    align-items: center;
    height: 100%;
    z-index: 1;
  }

 button {
  padding: 20px 60px;
  font-size: 2em;
  cursor: pointer;
  border: none;
  border-radius: 30px;
  background: linear-gradient(135deg, #00f0f5, #00d4d9);
  color: #fff;
  font-weight: bold;
  position: relative;
  overflow: hidden;
  box-shadow: inset 0 0 10px rgba(255,255,255,0.2),
              0 0 10px rgba(0,255,255,0.4);
  transition: all 0.4s ease;
  backdrop-filter: blur(4px);
  background-image: 
    linear-gradient(255deg, rgba(255,255,255,0.1), rgba(255,255,255,0));
  background-blend-mode: overlay;
}
button::before {
  content: "";
  position: absolute;
  top: -50%;
  left: -50%;
  width: 200%;
  height: 200%;
  background: radial-gradient(circle at 50% 50%, rgba(255,255,255,0.1), transparent 90%);
  transform: rotate(25deg);
  pointer-events: none;
  opacity: 0.8;
  transition: all 0.4s ease;
}
 button:hover {
  background: linear-gradient(135deg, #00f0f5, #00d4d9);
  box-shadow: inset 0 0 20px rgba(255,255,255,0.4),
              0 0 30px rgba(0,255,255,0.6);
  transform: scale(1.15) rotate(1deg);
}
button:hover::before {
  opacity: 1;
  transform: rotate(35deg) scale(1.1);
}
  .changelog-version {
    font-weight: 600;
    font-size: 15px;
    color: #fff;
  }
  .changelog-date {
    font-size: 13px;
    color: #fff;
  }
  .changelog-type {
    display: inline-block;
    padding: 2px 8px;
    border-radius: 12px;
    font-size: 12px;
    font-weight: 500;
    color: #fff;
    background-color: var(--changelog-type-bg);
  }

  /* Фон для записи */
  .changelog-entry {
    margin-bottom: 10px;
    padding: 15px 15px;
    background-color: var(--changelog-entry-bg);
    border-radius: 8px;
    box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);
    transition: background 0.2s, transform 0.2s;
  }
  /* Расположение блока слева с красивым стилем */
  #changelogContainer {
    display: none; /* по умолчанию скрыт */
    position: fixed; top: 85px; left: 20px; /* слева */
    width: 420px;
    max-height: 500px;
    overflow-y: auto;
    backdrop-filter: blur(4px);
    background: var(--chart-bg-color);
    padding: 10px;
    border-radius: 12px;
    box-shadow: 0 8px 20px rgba(0,0,0,0.2);
    z-index: 9999;
    font-family: 'Montserrat', sans-serif;
    font-size: 14px;
    color: #eee;
    transition: opacity 0.3s, transform 0.3s;
  }
  #changelogContainer.show {
    display: block;
    opacity: 1;
    transform: translateY(0);
  }
  #changelogContainer h4 {
    margin-top: 0;
    font-size: 18px;
    margin-bottom: 15px;
    font-weight: 600;
    border-bottom: 2px solid #ddd;
    padding-bottom: 8px;
    color: #eee;
  }

  /* Стиль для каждой записи */
  .changelog-entry {
    margin-bottom: 10px;
    padding: 12px 15px;
    background-color: var(--bg-color);
    border-radius: 8px;
    box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);
    transition: background 0.2s, transform 0.2s;
  }
  .changelog-entry:hover {
    background-color: var(--hover-bg-color);
    transform: translateY(-2px);
  }

  /* Заголовки внутри записи */
  .changelog-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px;
  }
  .changelog-version {
    font-weight: 600;
    font-size: 15px;
    color: var(--text-color);
  }
  .changelog-date {
    font-size: 13px;
    color: var(--text-color);
  }
  .changelog-type {
    display: inline-block;
    padding: 2px 8px;
    border-radius: 12px;
    font-size: 12px;
    font-weight: 500;
    color: #fff;
    background-color: #3498db;
  }
  /* Цвет для типов */
  .changelog-type.Добавлено { background-color: #27ae60; }
  .changelog-type.Исправлено { background-color: #f39c12; }
  .changelog-type.Общее { background-color: #8e44ad; }

#footer {
  position: fixed;
  bottom: 10px;
  width: 100%;
  text-align: center;
  font-family: 'Arial', sans-serif;
  font-size: 14px;
  color: #ffffffcc;
  padding: 12px 20px;
  box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
  border-radius: 16px 16px 0 0;
  backdrop-filter: blur(4px);
  transition: all 0.3s ease;
  cursor: default;
}

#footer span {
  display: inline-block;
  font-weight: 600;
  letter-spacing: 0.5px;
}
#footer span:hover {
  background: linear-gradient(135deg, rgba(15, 32, 39, 1), rgba(32, 58, 67, 1));
  box-shadow: 0 12px 30px rgba(0, 0, 0, 0.4);
  transform: translateY(-2px);
}
</style>
</head>
<body>
<div style="position: fixed; top: 20px; left: 20px; z-index: 9999;">
  <button id="changelogToggle" style="padding:15px 20px; border:none; border-radius:8px; background:var(background); color:#fff; cursor:pointer; font-weight:600; box-shadow: 0 2px 8px rgba(0,0,0,0.2); transition: all 0.6s ease;">
    Changelog
  </button>
</div>
<!-- Контейнер для отображения changelog -->
<div id="changelogContainer">
  <h4 style="margin-top:0;">История изменений</h4>
  <div id="changelogContent">Загружаем...</div>
</div>
<div class="buttons">
  <button onclick="window.open('graph.html', '_self')">График</button>
  <button onclick="window.open('description.html', '_self')">Описание</button>
  <button onclick="window.open('palitra.html', '_self')">Палитра</button>
  <button onclick="window.open('https://sagatheror.github.io/instrumenti/formalization.html', '_self')">Шаблоны</button>
</div>

<!-- Канвас фона -->
<canvas id="background"></canvas>

<!-- Новый футер -->
<div id="footer">
  <span>Создатель сайта: EmPsOn &copy; 2025</span>
</div>

<script>
   const sheetUrl = 'https://docs.google.com/spreadsheets/d/11i0Nwwbw09aJQFNkztrAUfx0G8PXzUfg1sZyjeIKjxQ/gviz/tq?sheet=Лист3';

  // Функция загрузки данных
  function loadChangelogFromSheet() {
    fetch(sheetUrl)
      .then(response => response.text())
      .then(text => {
        const jsonData = JSON.parse(text.substring(47).slice(0, -2));
        const rows = jsonData.table.rows;
        let entriesHtml = '';

        function formatDateToDDMMYY(dateStr) {
          const dateMatch = /Date\((\d+),\s*(\d+),\s*(\d+)\)/.exec(dateStr);
          if (dateMatch) {
            let year = parseInt(dateMatch[1], 10);
            let month = parseInt(dateMatch[2], 10);
            let day = parseInt(dateMatch[3], 10);
            month += 1;
            const dd = day.toString().padStart(2,'0');
            const mm = month.toString().padStart(2,'0');
            const yy = (year % 100).toString().padStart(2,'0');
            return `${dd}.${mm}.${yy}`;
          } else {
            return dateStr;
          }
        }

        rows.forEach(row => {
          const version = row.c[0].v;
          const rawDate = row.c[1].v;
          const date = formatDateToDDMMYY(rawDate);
          const type = row.c[2].v.trim();
          let description = row.c[3].v;

          description = description.replace(/^•\s?/gm, '<li>•</li>');
          const descriptionHtml = description
            .split('\n')
            .map(line => line.trim().startsWith('•') ? `<li>${line.trim()}</li>` : `<p>${line.trim()}</p>`)
            .join('');

          entriesHtml += `
            <div class="changelog-entry">
              <div class="changelog-header" style="display:flex; justify-content:space-between; align-items:center;">
                <div>
                  <span class="changelog-version">Версия ${version}</span>
                  <span class="changelog-date">[${date}]</span>
                </div>
                <div class="changelog-type ${type}">${type}</div>
              </div>
              <ul style="margin:0; padding-left:20px;">${descriptionHtml}</ul>
            </div>`;
        });

        document.getElementById('changelogContent').innerHTML = entriesHtml;
      })
      .catch(() => {
        document.getElementById('changelogContent').innerHTML = 'Не удалось загрузить историю изменений.';
      });
  }

  document.getElementById('changelogToggle').addEventListener('click', () => {
    const container = document.getElementById('changelogContainer');
    if (container.classList.contains('show')) {
      container.classList.remove('show');
    } else {
      loadChangelogFromSheet();
      container.classList.add('show');
    }
  });

  window.addEventListener('load', () => {
    loadChangelogFromSheet();
  });
  
  const canvas = document.getElementById('background');
  const ctx = canvas.getContext('2d');

  let width = window.innerWidth;
  let height = window.innerHeight;

  window.addEventListener('resize', () => {
    width = window.innerWidth;
    height = window.innerHeight;
    canvas.width = width;
    canvas.height = height;
  });

  const particlesCount = 150;
  const particles = [];

  for (let i = 0; i < particlesCount; i++) {
    particles.push({
      x: Math.random() * width,
      y: Math.random() * height,
      vx: (Math.random() - 0.5) * 1.5,
      vy: (Math.random() - 0.5) * 1.5,
      size: 2 + Math.random() * 2,
      hue: Math.random() * 360,
      opacity: 0.7 + Math.random() * 0.3
    });
  }

  let mouseX = width / 2;
  let mouseY = height / 2;

  document.addEventListener('mousemove', (e) => {
    mouseX = e.clientX;
    mouseY = e.clientY;
  });

  function animate() {
    ctx.clearRect(0, 0, width, height);
    const gradient = ctx.createLinearGradient(0, 0, width, height);
    gradient.addColorStop(0, 'rgba(15, 32, 39, 0.8)');
    gradient.addColorStop(1, 'rgba(32, 58, 67, 0.8)');
    ctx.fillStyle = gradient;
    ctx.fillRect(0, 0, width, height);

    for (let p of particles) {
      p.x += p.vx;
      p.y += p.vy;
      if (p.x < 0 || p.x > width) p.vx *= -1;
      if (p.y < 0 || p.y > height) p.vy *= -1;

      const distToMouse = Math.hypot(p.x - mouseX, p.y - mouseY);
      if (distToMouse < 150) {
        p.opacity = Math.min(p.opacity + 0.02, 1);
        const angle = Math.atan2(mouseY - p.y, mouseX - p.x);
        p.vx += Math.cos(angle) * 0.05;
        p.vy += Math.sin(angle) * 0.05;
      } else {
        p.opacity = Math.max(p.opacity - 0.01, 0.3);
      }

      ctx.beginPath();
      ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
      ctx.fillStyle = `hsla(${p.hue}, 80%, 60%, ${p.opacity})`;
      ctx.fill();
    }

    for (let i = 0; i < particles.length; i++) {
      for (let j = i + 1; j < particles.length; j++) {
        const p1 = particles[i];
        const p2 = particles[j];
        const dist = Math.hypot(p1.x - p2.x, p1.y - p2.y);
        if (dist < 100) {
          ctx.strokeStyle = `hsla(${(p1.hue + p2.hue) / 2}, 70%, 60%, 0.2)`;
          ctx.lineWidth = 1;
          ctx.beginPath();
          ctx.moveTo(p1.x, p1.y);
          ctx.lineTo(p2.x, p2.y);
          ctx.stroke();
        }
      }
    }

    requestAnimationFrame(animate);
  }

  canvas.width = width;
  canvas.height = height;
  animate();
</script>
</body>
</html>
